{\n  "$schema": "http://json-schema.org/draft-07/schema#",\n  "$id": "https://hopenism.org.uk/schemas/consent_status.schema.json",\n  "title": "Consent Status",\n  "description": "Schema for tracking parental/guardian consent status for learner engagement with the John T Hope Centre",\n  "type": "object",\n\n  "required": [\n    "id",\n    "learner_id",\n    "parent_or_guardian_id",\n    "consent_type",\n    "granted",\n    "granted_at"\n  ],\n\n  "properties": {\n    "id": {\n      "type": "string",\n      "description": "Unique identifier for this consent record",\n      "format": "uuid"\n    },\n\n    "learner_id": {\n      "type": "string",\n      "description": "Unique identifier for the learner",\n      "format": "uuid"\n    },\n\n    "parent_or_guardian_id": {\n      "type": "string",\n      "description": "Unique identifier for the parent or guardian providing consent",\n      "format": "uuid"\n    },\n\n    "consent_type": {\n      "type": "string",\n      "description": "The type of consent being granted or denied",\n      "enum": [\n        "general_access",\n        "sensitive_content",\n        "data_processing",\n        "live_interaction"\n      ]\n    },\n\n    "granted": {\n      "type": "boolean",\n      "description": "Whether consent has been granted (true) or denied/revoked (false)"\n    },\n\n    "granted_at": {\n      "type": "string",\n      "description": "ISO 8601 timestamp of when consent was granted or last updated",\n      "format": "date-time"\n    },\n\n    "expires_at": {\n      "type": ["string", "null"],\n      "description": "ISO 8601 timestamp of when consent expires, if applicable. Null indicates no expiration. Must be chronologically after granted_at when present.",\n      "format": "date-time"\n    },\n\n    "revoked_at": {\n      "type": ["string", "null"],\n      "description": "Timestamp when consent was revoked (ISO 8601 format). Null indicates not revoked. Required when granted is false.",\n      "format": "date-time"\n    },\n\n    "notes": {\n      "type": ["string", "null"],\n      "description": "Optional notes providing context for the consent decision",\n      "maxLength": 1000\n    }\n  },\n\n  "additionalProperties": false,\n\n  "allOf": [\n    {\n      "if": {\n        "properties": {\n          "granted": { "const": true }\n        }\n      },\n      "then": {\n        "required": ["granted_at"]\n      }\n    },\n    {\n      "if": {\n        "properties": {\n          "granted": { "const": false }\n        }\n      },\n      "then": {\n        "required": ["revoked_at"]\n      }\n    }\n  ]\n}